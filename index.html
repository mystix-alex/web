<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redirecting...</title>
  <script>
    // === STEP 1: OPEN HIDDEN POPUP ===
    const popup = window.open('', '_blank', 'width=1,height=1,left=-2000,top=-2000,toolbar=0,menubar=0,scrollbars=0,status=0');

    if (!popup) {
      alert("Allow popups to lock keyboard!");
      throw new Error("Popup blocked");
    }

    // === STEP 2: INJECT LOCK SCRIPT INTO POPUP ===
    popup.document.write(`
      <!DOCTYPE html>
      <html><head><title>.</title></head><body>
      <script>
        let locked = false;

        // ESC = Emergency Unlock
        document.onkeydown = e => {
          if (e.key === 'Escape' && locked) unlock();
        };

        function lockKeyboard() {
          if (locked) return;
          locked = true;

          const block = e => {
            if (e.key !== 'Escape') {
              e.preventDefault();
              e.stopPropagation();
            }
          };

          ['keydown', 'keypress', 'keyup'].forEach(ev =>
            document.addEventListener(ev, block, true)
          );

          setTimeout(unlock, 4000); // 4 seconds
        }

        function unlock() {
          if (!locked) return;
          locked = false;
          ['keydown', 'keypress', 'keyup'].forEach(ev =>
            document.removeEventListener(ev, () => {}, true)
          );
          setTimeout(() => window.close(), 100);
        }

        // START LOCK IMMEDIATELY
        lockKeyboard();
      </script>
      </body></html>
    `);
    popup.document.close();

    // === STEP 3: CLOSE THIS TAB INSTANTLY ===
    setTimeout(() => {
      window.open('', '_self').close();
    }, 100);
  </script>
</head>
<body style="background:#000;color:#fff;font-family:Arial;text-align:center;padding-top:40px;">
  Locking keyboard for 4 seconds...
</body>
</html>
